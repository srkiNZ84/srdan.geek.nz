<!doctype html><html lang=en><head><title>The rise of K8s for infrastructure management · Home of Srđan Đukić</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://disqus.com; img-src 'self' https://www.gravatar.com https://referrer.disqus.com https://c.disquscdn.com https://cdn.viglink.com; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://c.disquscdn.com; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://srdan-geek-nz.disqus.com https://c.disquscdn.com; connect-src 'self' https://www.google-analytics.com https://links.services.disqus.com;"><meta name=author content="Srđan Đukić"><meta name=description content="More and more people are looking to use the Kubernetes API for management of cloud resources"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="The rise of K8s for infrastructure management"><meta name=twitter:description content="More and more people are looking to use the Kubernetes API for management of cloud resources"><meta property="og:url" content="https://srdan.geek.nz/posts/tuesday-28th-sept/"><meta property="og:site_name" content="Home of Srđan Đukić"><meta property="og:title" content="The rise of K8s for infrastructure management"><meta property="og:description" content="More and more people are looking to use the Kubernetes API for management of cloud resources"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-28T22:01:55+13:00"><meta property="article:modified_time" content="2021-09-28T22:01:55+13:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="K8s"><meta property="article:tag" content="Iac"><meta property="article:tag" content="Crossplane"><meta property="article:tag" content="Operators"><meta property="article:tag" content="Cloud"><link rel=canonical href=https://srdan.geek.nz/posts/tuesday-28th-sept/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.022594d625780e2edf64581b893d32cb35c11de5d88953ea4ad3c2e45451e214.css integrity="sha256-AiWU1iV4Di7fZFgbiT0yyzXBHeXYiVPqStPC5FRR4hQ=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://srdan.geek.nz/>Home of Srđan Đukić
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://srdan.geek.nz/posts/tuesday-28th-sept/>The rise of K8s for infrastructure management</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2021-09-28T22:01:55+13:00>September 28, 2021
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
3-minute read</span></div><div class=authors><i class="fa-solid fa-user" aria-hidden=true></i>
<a href=/authors/sr%C4%91an-%C4%91uki%C4%87/>Srđan Đukić</a></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/kubernetes/>Kubernetes</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/k8s/>K8s</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/iac/>Iac</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/crossplane/>Crossplane</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/operators/>Operators</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/cloud/>Cloud</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/aws/>Aws</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/azure/>Azure</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/infrastructure/>Infrastructure</a></span></div></div></header><div class=post-content><h1 id=the-rise-of-k8s-for-infrastructure-management>The rise of K8s for infrastructure management
<a class=heading-link href=#the-rise-of-k8s-for-infrastructure-management><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>One of the typically overlooked aspects of moving to microservice architecture in general (and specificallyK8s for the purposes of this article) is the fact that each service &ldquo;owns&rdquo; its own datastore. Unless constrained by costs, this means a fully managed datastore instance (e.g. RDS). Once we accept that the service owns and manages the creation, upgrades etc&mldr; of its own datastore, it then becomes logical to store the &ldquo;infrastructure code&rdquo; for this next to the application code (i.e. in the same repository). This is good as it really gives the team responsible a sense of autonomy of their own infrastructure and, currently, likely looks like a bunch of Terraform files in a directory in version control, next to the application code.</p><p>The drawbacks of the above approach is that the team now has to learn Terraform, which can be a learning curve and has several concepts which don&rsquo;t fit nicely with the developer mindset (e.g. the heavy use of a &ldquo;statefile&rdquo;). If only there was a way to manage infrastructure the same way that we manage our deploy objects&mldr; 🤔</p><p>This is where tools like the <a href=https://github.com/Azure/azure-service-operator class=external-link target=_blank rel=noopener>Azure Service Operator</a>, <a href=https://crossplane.io/ class=external-link target=_blank rel=noopener>Crossplane.io</a> and <a href=https://github.com/aws-controllers-k8s/community class=external-link target=_blank rel=noopener>AWS Controllers for Kubernetes (ACK)</a> come in. They allow a development team (or anyone really) to define their cloud infrastructure objects using Kubernetes API objects.</p><p>For example, to define an Azure Cache for Redis instance using the Azure Service Operator, you would include the following in your Helm charts (or whatever tool you use to deploy):<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>azure.microsoft.com/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>RedisCache</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>azure-redis</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>location</span>: <span style=color:#ae81ff>eastus2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>properties</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>sku</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Basic</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>family</span>: <span style=color:#ae81ff>C</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>capacity</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>enableNonSslPort</span>: <span style=color:#66d9ef>true</span></span></span></code></pre></div></p><p>To define an AWS CloudFront distribution using Crossplane, you would do the following:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>cloudfront.aws.crossplane.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Distribution</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>example-distribution</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>forProvider</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>region</span>: <span style=color:#ae81ff>us-east-1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>distributionConfig</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>comment</span>: <span style=color:#ae81ff>Example CloudFront Distribution</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>origins</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>items</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>domainName</span>: <span style=color:#ae81ff>test-bucket.s3.amazonaws.com</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>id</span>: <span style=color:#ae81ff>s3Origin</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>s3OriginConfig</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>originAccessIDentity</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>defaultCacheBehavior</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>targetOriginID</span>: <span style=color:#ae81ff>s3Origin</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>viewerProtocolPolicy</span>: <span style=color:#ae81ff>allow-all</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>minTTL</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>forwardedValues</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>cookies</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>forward</span>: <span style=color:#ae81ff>none</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>queryString</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>providerConfigRef</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>example</span></span></span></code></pre></div></p><p>The above is excellent! It makes brilliant use of the K8s control loop to ensure we have our declarative infrastructure, while also re-purposing the K8s API, extending it in a way that&rsquo;s natural and useful. It also does this without forcing developers to learn a new DSL (the presumption being that everyone knows YAML).</p><p>Out of the three listed, Crossplane looks the most polished at the moment, however, it is targetting several clouds and has features like <a href=https://crossplane.io/docs/v1.4/reference/composition.html class=external-link target=_blank rel=noopener>composition</a>, so might feel &ldquo;heavy&rdquo; when compared to the &ldquo;native&rdquo; offerings. In saying that, it seems to have much more support, in terms of infrastructure objects, on AWS than ACK. Another alternative to the above tools might be <a href=https://operatorhub.io/ class=external-link target=_blank rel=noopener>OperatorHub.io</a>, which seems to be a website that aggregates K8s operators and makes them easy to find. This option might makes sense when there is a high trust environment and teams are able to install their own Operators.</p><p>These tools give a way to use the same workflow and tools for handling your applications&rsquo; managed cloud infrastructure that you already use for your &ldquo;deployment&rdquo; infrastructure (i.e. Deployments, Services, ConfigMaps and Secrets). As such, they continue to push for greater team autonomy, while also having safety benefits by allowing infrastructure and application changes to be versioned, tested and deployed together.</p></div><footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//srdan-geek-nz.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}(),document.addEventListener("themeChanged",function(){document.readyState=="complete"&&DISQUS.reset({reload:!0,config:disqus_config})})</script></footer></article></section></div><footer class=footer><section class=container>©
2019 -
2025
Srđan Đukić
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>